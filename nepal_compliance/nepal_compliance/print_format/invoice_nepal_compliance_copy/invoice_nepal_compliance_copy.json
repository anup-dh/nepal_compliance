{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-06-25 14:46:47.848244",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Purchase Invoice",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "<style>\n    .invoice-copy {\n        display: block;\n        page-break-after: always;\n        margin-bottom: 50px;\n    }\n\n    .invoice-section {\n        border: none;\n        padding: 20px;\n    }\n\n    .company-header {\n        display: flex;\n        align-items: center;\n        /*gap: 20px;*/\n        position: relative;\n        margin-bottom: 30px;\n        margin-top: 20px;\n    }\n\n    .company-logo img {\n        height: 60px;\n        width: auto;\n        align-items: left;\n    }\n\n    .company-logo {\n        min-height: 60px;\n        display: flex;\n        align-items: center;\n    }\n\n    .company-details {\n        font-size: 14px;\n        line-height: 1.6;\n        position: absolute;\n        left: 50%;\n        transform: translateX(-50%);\n        text-align: center;\n    }\n\n    .company-details .company-name {\n        font-size: 18px;\n        font-weight: bold;\n        text-transform: uppercase;\n    }\n\n    .copy-label {\n        margin-top: 5px;\n        font-weight: bold;\n        font-size: 14px;\n        text-transform: uppercase;\n    }\n\n    .title {\n        text-align: center;\n        font-size: 16px;\n        font-weight: bold;\n        margin-bottom: 15px;\n        text-transform: uppercase;\n        border-top: 1px dashed #000;\n        padding-top: 5px;\n    }\n\n    .invoice-header {\n        display: flex;\n        justify-content: space-between;\n        font-size: 12px;\n    }\n\n    .invoice-header div {\n        display: flex;\n        flex-direction: column;\n    }\n\n    table {\n        width: 100%;\n        border-collapse: collapse;\n        margin-top: 10px;\n        border: 1.5px solid black;\n    }\n\n    th, td {\n        border: 1.5px solid black;\n        padding: 8px;\n        font-size: 12px;\n    }\n\n    th {\n        font-weight: bold;\n        color: black;\n    }\n\n    .user-printed {\n        font-size: 12px;\n        text-align: right;\n        font-weight: normal;\n        color: #555;\n    }\n</style>\n\n{% set is_return = doc.is_return or doc.return_against %}\n{% if doc.docstatus == 1 %}\n{% set actual_print_count = frappe.get_list(\"Access Log\", filters={\n    \"reference_document\": doc.name, \n    \"file_type\": \"PDF\",\n    \"method\": \"Print\"\n}, ignore_permissions=True, limit_page_length=50) | length %}\n{% else %}\n    {% set actual_print_count = 0 %}\n{% endif %}\n{% set copy_no = actual_print_count %}\n{% if is_return %}\n    {% set titles = [\"DEBIT NOTE\"] %}\n{% elif doc.status == \"Cancelled\" %}\n    {% set titles = [\"Cancelled\"] %}\n{% elif actual_print_count == 0 %}\n    {% set titles = [\"TAX INVOICE\", \"INVOICE\"] %}\n{% else %}\n    {% set titles = [\"INVOICE\"] %}\n{% endif %}\n{% set company = frappe.get_doc(\"Company\", doc.company) %}\n\n{% for title in titles %}\n<div class=\"invoice-copy\">\n    <div class=\"invoice-section\">\n        {% set address_doc = None %}\n        {% set company_link = frappe.get_all(\n            \"Dynamic Link\",\n            filters = {\"link_doctype\": \"Company\", \"link_name\": doc.company},\n            fields  = [\"parent\"],\n            order_by = \"creation desc\",\n            limit   = 1\n        )%}\n        {% if company_link %}\n        {% set address_doc = frappe.get_doc(\"Address\", company_link[0].parent) %}\n        {% endif %}\n        \n        {% set supplier_address = None %}\n        {% if doc.supplier %}\n            {% set address_links = frappe.get_all(\"Dynamic Link\", filters={\n                \"link_doctype\": \"Supplier\",\n                \"link_name\": doc.supplier\n            }, fields=[\"parent\"], limit=1) %}\n            {% if address_links %}\n                {% set supplier_address = frappe.get_doc(\"Address\", address_links[0].parent) %}\n            {% endif %}\n        {% endif %}\n\n        <div class=\"company-header\">\n            <div class=\"company-logo\">\n                {% if company.logo_for_printing %}\n                    <img src=\"{{ company.logo_for_printing }}\" alt=\"Company Logo\">\n                {% else %}\n                    <div style=\"font-size: 12px; color: gray;\">[Attach Logo in Company Doctype]</div>\n                {% endif %}\n            </div>\n            <div class=\"company-details\" style=\"font-family: Arial, monospace; font-size: 12px; line-height: 1.5; display: flex; flex-direction: column; align-items: center;\">\n                <div class=\"company-name\">{{ company.name }}</div>\n                <div>\n                    {% if address_doc and (address_doc.city or address_doc.country) %}\n                        {{ address_doc.city }}{% if address_doc.city and address_doc.country %}, {% endif %}{{ address_doc.country }}\n                    {% else %}\n                        Address:\n                    {% endif %}\n                </div>\n                <div>\n                    {% if address_doc and address_doc.phone %}{{ address_doc.phone }}{% else %}Tel/Mob: {% endif %}\n                </div>\n                <div>{{company.email or \"\"}}</div>\n                <div>VAT: {{ company.tax_id or \"\" }}</div>\n                {% if not is_return and copy_no > 0 %}\n                    <div class=\"copy-label\">Copy of Original {{ copy_no }}</div>\n                {% endif %}\n            </div>\n        </div>\n\n        <div class=\"title\">{{ title }}</div>\n\n        <div class=\"invoice-header\">\n            <div>\n                <p><strong>Invoice No:</strong> {{ doc.name }}</p>\n                <p><strong>Supplier:</strong> {{ doc.supplier_name }}</p>\n                <p><strong>Tax ID:</strong> {{ doc.tax_id or \"\" }}</p>\n            </div>\n            <div>\n                <p><strong>Date:</strong> {{ frappe.utils.formatdate(doc.posting_date) }}</p>\n                <p><strong>Miti:</strong> {{ doc.nepali_date }}</p>\n                <p><strong>Printed By:</strong> {{ frappe.session.user }}</p>\n            </div>\n        </div>\n        <!--<p><strong>Address:</strong> {{ supplier_address.address_line1 }}</p>-->\n        {% if supplier_address %}\n            <p><strong>Address:</strong> {{ supplier_address.address_line1 }}</p>\n        {% else %}\n            <p><strong>Address:</strong> N/A</p>\n        {% endif %}\n        \n        <table>\n            <thead>\n                <tr>\n                    <th>S.N</th>\n                    <th>H.S. Code</th>\n                    <th>Item</th>\n                    <!--<th>Description</th>-->\n                    <th>Qty</th>\n                    <th>Rate</th>\n                    <th>Discount</th>\n                    <th>Amount</th>\n                </tr>\n            </thead>\n            <tbody>\n                {% for item in doc.items %}\n                <tr>\n                    <td>{{ loop.index }}</td>\n                    <td>{{ item.hs_code or \"\" }}</td>\n                    <td>{{ item.item_code }}</td>\n                    <!--<td>{{ item.description }}</td>-->\n                    <td>{{ abs(item.qty) }}</td>\n                    <td>{{ abs(item.rate) if item.discount_amount else abs(item.price_list_rate) }}</td>\n                    <td>{{ abs(item.discount_amount) }}</td>\n                    <td>{{ abs(item.amount) }}</td>\n                </tr>\n                {% endfor %}\n            </tbody>\n\n            {% set ns = namespace(taxable_amount=0, nontaxable_amount=0) %}\n            {% if doc.discount_amount %}\n                {% set discount_amount = doc.discount_amount %}\n            {% else %}\n                {% set ns_discount = namespace(total=0) %}\n                {% for item in doc.items %}\n                    {% set ns_discount.total = ns_discount.total + (item.discount_amount or 0) %}\n                {% endfor %}\n                {% set discount_amount = ns_discount.total %}\n            {% endif %}\n\n            {% for item in doc.items %}\n                {% if item.is_nontaxable_item %}\n                    {% set ns.nontaxable_amount = ns.nontaxable_amount + (item.net_amount or item.amount) %}\n                {% else %}\n                    {% set ns.taxable_amount = ns.taxable_amount + (item.net_amount or item.amount) %}\n                {% endif %}\n            {% endfor %}\n\n            {% set vat_amount = abs(ns.taxable_amount * 0.13) if ns.taxable_amount and doc.total_taxes_and_charges else abs(doc.total_taxes_and_charges) %}\n            {% set subtotal = abs(doc.total or 0) %}\n            {% set grand_total = abs(doc.rounded_total or (ns.taxable_amount + ns.nontaxable_amount + vat_amount)) %}\n            <tfoot>\n                <tr>\n                    <td colspan=\"4\" rowspan=\"6\" style=\"vertical-align: top; padding: 10px;\">\n                        <strong>Amount in Words:</strong> \n                        {{ doc.in_words or \"\" }}\n                    </td>\n                    <td colspan=\"2\" style=\"text-align: center;\"><strong>Subtotal</strong></td>\n                    <td style=\"text-align: right;\">{{ doc.currency }} {{ \"{:,.2f}\".format(subtotal) }}</td>\n                </tr>\n                <tr>\n                    <td colspan=\"2\" style=\"text-align: center;\"><strong>Discount</strong></td>\n                    <td style=\"text-align: right;\">{{ doc.currency }} {{ \"{:,.2f}\".format(abs(doc.discount_amount)) }}</td>\n                </tr>\n                <tr>\n                    <td colspan=\"2\" style=\"text-align: center;\"><strong>Non Taxable Amount</strong></td>\n                    <td style=\"text-align: right;\">{{ doc.currency }} {{ \"{:,.2f}\".format(abs(ns.nontaxable_amount)) }}</td>\n                </tr>\n                <tr>\n                    <td colspan=\"2\" style=\"text-align: center;\"><strong>Taxable Amount</strong></td>\n                    <td style=\"text-align: right;\">{{ doc.currency }} {{ \"{:,.2f}\".format(abs(ns.taxable_amount)) }}</td>\n                </tr>\n                <tr>\n                    <td colspan=\"2\" style=\"text-align: center;\"><strong>13% VAT</strong></td>\n                    <td style=\"text-align: right;\">{{ doc.currency }} {{ \"{:,.2f}\".format(abs(vat_amount)) }}</td>\n                </tr>\n                <tr>\n                    <td colspan=\"2\" style=\"text-align: center;\"><strong>Total Amount</strong></td>\n                    <td style=\"text-align: right;\">{{ doc.currency }} {{ \"{:,.2f}\".format(abs(grand_total)) }}</td>\n                </tr>\n            </tfoot>\n        </table>\n    </div>\n</div>\n{% endfor %}\n",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2025-09-01 11:19:48.070454",
 "modified_by": "Administrator",
 "module": "Nepal Compliance",
 "name": "Invoice Nepal Compliance Copy",
 "owner": "Administrator",
 "page_number": "Hide",
 "pdf_generator": "wkhtmltopdf",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}